# Test Apps

The CSD test apps ([/samples](https://github.com/intel/camera-streaming-daemon/tree/master/samples)) provide a simple mechanism to test/validate different CSD functionality.

## Build the Test Apps

Enter the following command from the CSD root directory to build the test apps:

```
make samples
```

The tests are then run as described in the following sections.


## Test Avahi (camera-sample-client)

This test outputs all RTSP streams being published by *Avahi*.

To run this test app:
1. Start the CSD for your platform:
   ```
   ./csd -c samples/files/ubuntu.conf
   ```
   > **Tip** Use the [CSD Configuration File](../guide/configuration_file.md) for your platform (above we use the Ubuntu configuration).
   
1. In a separate terminal (or on another computer connected to the target drone on the same network) run the test app:
   ```
   ./samples/camera-sample-client
   ```

The program will output all published CSD streams. Below we show example output for a system with a single camera attached:
```bash
Service resolved: '/video0' (rtsp://10.0.2.15:8554/video0)
TXT: ["name=VirtualBox Webcam - Integrated " "frame_size[0]=MJPG(640x480,160x120,320x180,320x240,424x240,640x360,848x480,960x540,1280x720,1920x1080)"]
```
<!-- How do I enable log debug? -->


## Test MAVLink Publishing of RTSP Streams (camera-sample-mavlink-client)

This is an interactive test of MAVLink stream publishing. The available streams are listed and the selected stream, with the selected resolution, is played.

To run this app:
1. Start the CSD for your platform:
   ```
   ./csd -c samples/files/ubuntu.conf
   ```
   > **Tip** Use the [CSD Configuration File](../guide/configuration_file.md) for your platform (above we use the Ubuntu configuration).
1. In a separate terminal (or on another computer connected to the target drone on the same network) run the test app:
   ```
   ./samples/camera-sample-mavlink-client
   ```

The output will be similar to:
```bash
Open UDP [5]
Bind UDP [5] 0.0.0.0:14550
Camera Daemon found: sysid: 42

Streams found:
1 - Integrated_Webcam_HD

    Please make your selection (type stream number):
1
Select Horizontal resolution (0 for default): 
0
Select Vertical resolution (0 for default): 
0
Stream Information:
   Status: not streaming
   Resolution: 1280x720
   URI: rtsp://192.168.8.1:8554//video0
```

And if *gstreamer* client *gst-launch-1.0* is installed, the selected video will be played.


<!-- Open issue: https://github.com/intel/camera-streaming-daemon/issues/132 -->

## Demo code for Extending CSD (camera-sample-custom)

This test app demonstrates how to extend CSD by adding extra streams. This app exports all streams exported by CSD and one extra stream with a dummy video generated by the *videotestsrc gstreamer plugin*.

> **Note** The test source code accompanies the guide material in: [Extend CSD > Camera Sample Custom](../guide/extending_csd.md#camera-sample-custom).

To test it:

1. Run the example using configuration for your platform:
   ```
   ./samples/camera-sample-custom -c samples/files/ubuntu.conf
   ```
   > **Tip** Use the [CSD Configuration File](../guide/configuration_file.md) for your platform (above we use the Ubuntu configuration).

1. Watch the video identified by /custom using *vlc*, for example:
   ```
   vlc rtsp://192.168.1.1:8554/custom
   ```
1. (Optional) Use the `-h` argument to list the test app's other command line options:
   ```
   ./samples/camera-sample-custom -h
   ```
   
<!-- Open issue: https://github.com/intel/camera-streaming-daemon/issues/131  -->